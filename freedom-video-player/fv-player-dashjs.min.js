function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FV_Player_Dash_Js_DebugMock(){var t;return t={getLogger:function(e){return{fatal:function(e){t.log.fatal=e}.bind(e),error:function(e){t.log.error=e}.bind(e),warn:function(e){t.log.warn=e}.bind(e),info:function(e){t.log.info=e}.bind(e),debug:function(e){t.log.debug=e}.bind(e)}},log:{}}}(()=>{function e(r,_){function i(e,t,a){return"application/dash+xml"===e.toLowerCase()&&p.isTypeSupported(t+';codecs="'+a+'"')&&(a.indexOf("mp4a.40.5")<0||o.indexOf("Android")<0)}function e(h,d){function m(e,t,a){var i={code:e};return 2<e&&(i.video=C(h.video,{src:t,url:a||t})),i}function c(a,t,e){function i(e){return isNaN(Number(e))?e.level:e}function r(e,t,a,i){-1==(e=Math.min(e,t.length-1))?v.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0},limitBitrateByPortal:!0,usePixelRatioInLimitBitrateByPortal:!0}}}):i?v.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0},minBitrate:{video:t[e].bandwidth/1e3}}}}):v.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!1},initialBitrate:{video:t[e].bandwidth/1e3}}}}),a&&(h.video.quality=e)}var o,n,s=[],l=0,u=a&&f.inlineVideo&&1===e.Period_asArray.length&&(!k||D.qualitiesForSafari);if(u&&(e.Period_asArray[0].AdaptationSet_asArray.forEach(function(e){var t=e.Representation_asArray,a=e.mimeType||t[0].mimeType;0===a.indexOf("video/")?s=s.concat(t.filter(function(e){e=(e.mimeType||a)+";codecs="+e.codecs;return p.isTypeSupported(e)})):0===a.indexOf("audio/")&&(l=l||t[0].bandwidth)}),!(s.length<2)))if(s.sort(function(e,t){return e.bandwidth-t.bandwidth}),localStorage.FVPlayerDashQuality&&(Object.keys(s).forEach(function(e){h.conf.dash&&"restore"==h.conf.dash.initialVideoQuality&&localStorage.FVPlayerDashQuality<=s[e].height&&(t=h.conf.dash.initialVideoQuality=e,console.log("restoring quality "+localStorage.FVPlayerDashQuality+" => "+e))}),h.conf.dash)&&"restore"==h.conf.dash.initialVideoQuality&&(t=h.conf.dash.initialVideoQuality=s.length-1),u){switch(_typeof(a)){case"object":n=a.map(i);break;case"string":n=a.split(/\s*,\s*/).map(Number);break;default:(n=s.map(function(e,t){return t})).unshift(-1)}(n=n.filter(function(e){return e<s.length&&-2<e})).length<2||(h.video.qualities=n.map(function(t){var e=s[t],e=("object"===_typeof(a)?a.filter(function(e){return i(e)===t})[0]:t).label||(t<0?"Auto":Math.min(e.width,e.height)+"p ("+Math.round((e.bandwidth+l)/1e3)+"k)");return{value:t,label:e}}),_.conf.hd_streaming&&!_.support.fvmobile?(o=-1,Object.keys(s).forEach(function(e){-1==o&&(720<=s[e].height||1280<=s[e].width)&&(o=e)}),r(o,s,!0,!0)):r(t,s,!0))}else r(t,s)}var v,b,S=_.bean,f=_.support,w=f.browser,k=w.safari&&f.dataload,P=!1;return{engineName:A,pick:function(e){e=e.filter(function(e){var t=e.dashType||D.type,a=e.dashCodecs||D.codecs;return i(e.type,t,a)})[0];return"string"==typeof e.src&&(e.src=E.createAbsoluteUrl(e.src)),e},load:function(e){var p=h.conf,g=C(D,p.dash,e.dash),l=e.dashQualities||p.dashQualities,t={ended:"finish",loadeddata:"ready",pause:"pause",play:"resume",progress:"buffer",ratechange:"speed",seeked:"seek",timeupdate:"progress",volumechange:"volume",error:"error",waiting:"waiting"},a=r.MediaPlayer.events,i=e.dash&&e.dash.protection,u=!!e.autoplay||!!p.autoplay||!!p.splash,y=0;!1===e.dashQualities?l=!1:void 0===l&&(l=!0),v?v.reset():((b=E.findDirect("video",d)[0]||E.find(".fp-player > video",d)[0])&&(E.find("source",b).forEach(function(e){e.removeAttribute("src")}),b.removeAttribute("src"),b.load(),E.removeNode(b)),b=E.createElement("video",{class:"fp-engine dash-engine"}),Object.keys(t).forEach(function(e){var d,c=t[e],f=e+"."+A;S.on(b,f,function(e){p.debug&&c.indexOf("progress")<0&&console.log(f,"->",c,e.originalEvent);var t,a,i=b.currentTime,r=v.time&&v.time()||i,o=v.duration(),n=b.buffered,s=[],l=h.video,u=l.src;switch(c){case"ready":d=C(l,{duration:o,seekable:o,width:b.videoWidth,height:b.videoHeight,url:u});break;case"seek":d=r;break;case"progress":d=h.live&&!h.dvr?i-(y=!y&&i?i:y):r;break;case"speed":if(!g.debug)return void e.preventDefault();d=b.playbackRate;break;case"volume":d=b.volume;break;case"buffer":for(t=0;t<n.length;t+=1)s.push(n.end(t));if(d=s.filter(function(e){return r<=e}).sort()[0],void 0===(l.buffer=d))return;break;case"error":a=b.error&&b.error.code,d=m(a,u);break;case"waiting":b.currentTime>b.duration-.5&&(console.log("FV Player DASH: Triggering video end!"),h.trigger("finish",[h]))}h.trigger(c,[h,d])})}),h.on("error."+A,function(){v&&h.engine.unload()}),h.on("quality."+A,function(e,t,a){v.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:a<0},limitBitrateByPortal:-1==a,usePixelRatioInLimitBitrateByPortal:-1==a}}}),-1<a&&v.setQualityFor("video",a),0}),E.prepend(E.find(".fp-player",d)[0],b)),v=r.MediaPlayer().create(),h.engine[A]=v,i&&(v.setProtectionData(i),v.on(r.Protection.events.KEY_SYSTEM_SELECTED,function(e){e.data.keySystem.systemString})),v.updateSettings({streaming:{fastSwitchEnabled:o.indexOf("Trident/7")<0,lastBitrateCachingInfo:{enabled:!1},scheduleWhilePaused:!0,useSuggestedPresentationDelay:g.useSuggestedPresentationDelay}}),"number"==typeof g.liveDelay&&v.updateSettings({streaming:{liveDelay:g.liveDelay}}),"number"==typeof g.liveDelayFragmentCount&&v.updateSettings({streaming:{liveDelayFragmentCount:g.liveDelayFragmentCount}}),g.xhrWithCredentials&&g.xhrWithCredentials.length&&g.xhrWithCredentials.forEach(function(e){v.setXHRWithCredentialsForType(e,!0)}),Object.keys(a).forEach(function(o){var e=a[o],n=A+e.charAt(0).toUpperCase()+e.slice(1),t=g.listeners,s=t&&-1<t.indexOf(n);v.on(e,function(e){var t,a=h.video.src,i=h.video.dash,r="is-loading";h.conf.errors;switch(o){case"MANIFEST_LOADED":w.chrome&&i&&i.protectionLevel&&v.getProtectionController().setRobustnessLevel(i.protectionLevel),c(l,g.initialVideoQuality,e.data);break;case"CAN_PLAY":k&&u&&(E.addClass(d,r),S.one(b,"timeupdate."+A,function(){setTimeout(function(){E.removeClass(d,r)})}));break;case"BUFFER_LEVEL_STATE_CHANGED":E.toggleClass(d,"is-seeking","bufferStalled"===e.state);break;case"PLAYBACK_NOT_ALLOWED":if(!p.mutedAutoplay)throw new Error("Unable to autoplay");h.debug("Play errored, trying muted",e),k?(console.log("FV Player: Safari autoplay of Dash video blocked, retrying..."),P=!0):(h.mute(!0,!0),b&&(b.volume=0),h.play());break;case"ERROR":t=m(4,a),h.trigger("error",[h,t]);break;case"PLAYBACK_PAUSED":_.support.browser.chrome&&!_.support.android&&h.loading&&h.paused&&!h.ready&&!h.playing&&h.one("ready",function(e,t){t.trigger("pause")});break;case"PLAYBACK_STALLED":P&&(P=!1,console.log("FV Player: Safari autoplay of Dash video recovery"),h.mute(!0,!0),b.autoplay=!0,h.paused=!0,h.play())}s&&h.trigger(n,[h,e])})}),h.video=e,2.6<=parseFloat(r.Version)&&e.manifest?(v.initialize(b,!1,u),(i=r.FactoryMaker.getClassFactory({__dashjs_factory_name:"DashParser"})({}).create({debug:new FV_Player_Dash_Js_DebugMock,errorHandler:{manifestError:function(e,t,a,i){console.log("FV Player DashParser error",e,i)}}}).parse(e.manifest)).loadedTime=new Date,v.attachSource(i)):v.initialize(b,e.src,u),!f.firstframe&&f.dataload&&!w.mozilla&&u&&b.paused&&b.load()},resume:function(){v.play()},pause:function(){v.pause()},seek:function(e){v.seek(e)},volume:function(e){b&&(b.volume=isNaN(e)?1:e)},mute:function(e){b&&(b.muted=!!e,e?b.volume=0:localStorage.volume&&(b.volume=localStorage.volume),h.trigger("volume",[h,b.volume]),h.trigger("mute",[h,e]))},speed:function(e){b.playbackRate=e,h.trigger("speed",[h,e])},unload:function(){var e;v&&(e="."+A,v.reset(),v=0,h.off(e),S.off(d,e),S.off(b,e),E.removeNode(b),b=0)}}}var D,A="dash",p=window.MediaSource||window.WebKitMediaSource,o=navigator.userAgent,E=_.common,C=_.extend;p&&"function"==typeof p.isTypeSupported&&(e.engineName=A,e.canPlay=function(e,t){return D=C({type:"video/mp4",codecs:"avc1.42c01e,mp4a.40.2",initialVideoQuality:-1,qualitiesForSafari:!0},t[A],t.clip[A]),i(e,D.type,D.codecs)},_.engines.unshift(e))}"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.bind(void 0,require("dashjs")):window.dashjs&&window.flowplayer&&e(window.dashjs,window.flowplayer)})();